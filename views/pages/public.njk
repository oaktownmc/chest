{% extends "templates/base.njk" %}
{% from "../components/nav.njk" import nav %}

{% block head %}
  <title>oak chest</title>
  <meta property="og:title" content="oak chest | public chest" />
{% endblock %}

{% block body %}
  <div class="container">
    <h1>Public Chest</h1>
    <table>
      <tr>
        <th>Filename</th>
        <th>Size</th>
        <th>Date</th>
      <tr>
      {% for file in publicUploads %}
        <tr>
          <td><a href="/uploads/{{ file.filename }}" target="_blank">{{ file.original_filename }}</a></td>
          <td>{{ file.size | formatBytes }}</td>
          <td>{{ file.create_time | time_format | escape }}</td>
        </tr>
      {% endfor %}
    </table>
    {% if totalPages > 1 %}
      <div class="pagination">
        {% if page > 1 %}
          <a href="?page={{ page - 1 }}" class="prev">←</a>
        {% endif %}

        {% if totalPages <= 3 %}
          {% set start = 1 %}
        {% elseif page <= 2 %}
          {% set start = 1 %}
        {% elseif page >= totalPages - 1 %}
          {% set start = totalPages - 2 %}
        {% else %}
          {% set start = page - 1 %}
        {% endif %}

        {% for p in range(start, start + 3) %}
          {% if p <= totalPages %}
            {% if p == page %}
              <span class="current">{{ p }}</span>
            {% else %}
              <a href="?page={{ p }}">{{ p }}</a>
            {% endif %}
          {% endif %}
        {% endfor %}

        {% if page < totalPages %}
          <a href="?page={{ page + 1 }}" class="next">→</a>
        {% endif %}
      </div>
    {% endif %}
    {{ nav("public") }}
  </div>
{% endblock %}
